# Модуль 1: Введение в Node.js

### Что такое Node.js?

Платформа Node.js – это среда выполнения JavaScript на стороне сервера. Это означает, что разработчики могут использовать тот же язык программирования как для front-end, так и для back-end части веб-приложений, над которыми они работают. Новая версия Node.js появляется по меньшей мере дважды в год.

Согласно опросу Stack Overflow 2019, Node.js является самым популярным инструментом в категории «Фреймворки, библиотеки и инструменты» и имеет 50% выбора среди профессиональных разработчиков.

### Цели, задачи Node.js

##### Разработка API

Это, наверное, самый популярный вид приложений на сегодняшний момент. Почти все веб-приложения требуют сервера для связи с базами данных или другими внешними службами. Благодаря большому сообществу вы можете легко найти библиотеку для создания, например, REST или GraphQL API.

##### Создание стриминговых приложений

Node.js – хороший выбор для потоковой передачи данных. Можно создавать потоковые услуги для прослушивания музыки или просмотра видео. Он имеет встроенный модуль потоков, позволяющий последовательно передавать огромное количество данных по частям. Благодаря этому вам вообще не нужно временно хранить или кэшировать данные в памяти приложения.

##### Применение реального времени

Можно создавать приложения типа чатов или видеоконференций, где люди могут разговаривать друг с другом в реальном времени. Например, такие программы, как Slack или Discord, написаны на Node.js. Или инструменты для совместной работы над одним и тем же документом одновременно для нескольких людей.

##### **Microservices**

Микросервисы в последнее время стали популярным подходом к разработке приложений. Благодаря легковесности и простоте Node.js это лучшая и легко масштабируемая технология для создания и развертывания микросервисов.

##### Консольные приложения

Благодаря множеству доступных пакетов в NPM репозитории можно легко создавать инструменты командной строки любой сложности.

##### Настольные приложения

Благодаря фреймворку Electron мы можем строить настольные приложения на основе веб-технологий. Это текстовые редакторы Atom и Visual Studio Code, а также упоминавшийся ранее чат-сервис Slack.

#### Основные преимущества

-   Репозитории NPM с открытым исходным кодом в GitHub. Здесь находится множество доступных модулей и вы можете легко найти готовое решение для вашего приложения, вместо того, чтобы изобретать велосипед.
-   С Node.js легко масштабировать приложение по горизонтали, разворачивая множество экземпляров вашего проекта на разных серверах. Также доступно вертикальное масштабирование, используя встроенный модуль cluster, который будет разветвлять процесс приложения на все имеющиеся у вас ядра CPU.
-   Многие компании выбирают Node.js, когда хотят перейти на микросервисы. Он идеально зарекомендовал себя для этого архитектурного решения.
-   На сегодняшний день основным языком для front-end является JavaScript. Использование его на стороне back-end позволяет использовать вам full-stack разработчика, а не нанимать двух человек для разных позиций. Экономия времени и денег для бизнеса всегда была и будет большим преимуществом.
-   Основная проблема с операциями ввода-вывода – это ожидание ответа. Использование неблокирующего API позволяет продолжить работу над другой задачей, не дожидаясь ответа предыдущего. И только когда операция ввода-вывода будет завершена, вы получите сообщение об этом с помощью обратного вызова или промеса. Главное преимущество этого подхода – повышение эффективности за счет обработки большого количества одновременных подключений.
-   Поскольку основным языком является JavaScript, вы можете легко обмениваться частями кода между разными компонентами вашей системы. Более того, вы можете использовать одни и те же части кода как в front-end, так и в back-end части приложения.
-   Очень часто бизнес имеет отличную идею, которую нужно проверить на рынке. С помощью Node.js вы можете очень быстро предоставить MVP (Минимально жизнеспособный продукт, minimum viable product, MVP – продукт, обладающий минимальными, но достаточными для удовлетворения первых потребителей, функциями), что уменьшит количество денег и усилий, необходимых для его реализации.
-   С момента создания Node.js в 2009 году многие компании могли проверить, как Node.js работает на производстве. И технология показала себя хорошо, поэтому многие крупные компании решили перейти на Node.js.

#### Какие компании используют Node.js в своих приложениях?

Список компаний, использующих Node.js в производстве, достаточно велик: Netflix, Microsoft, Uber и другие. Capital One – огромная финансовая корпорация, выполняющая множество проектов из-за коротких циклов разработки на Node.js. Рекламные агентства, такие как Fusion Marketing, Walmart в розничной торговле, Uber в транспорте, Google, Twitter, GoDaddy и список можно продолжать и продолжать.

Если вам интересен опыт применения Node.js от других компаний, существует серия бесед с Node Enterprise, где каждый эпизод посвящен отдельному варианту использования Node.js.

[Node Enterprise](https://www.youtube.com/watch?v=L-0xS3HjLiM)

### Свойства Node.js

#### Асинхронность

Асинхронность является ключевой особенностью Node.js, и понимание этого принципа критически важно для успешной разработки на этой платформе.

#### Что такое асинхронное программирование?

-   В традиционном (синхронном) программировании задачи выполняются последовательно, одна за другой. Это значит, что следующая задача должна ждать, пока завершится предыдущая. Ниже псевдокод — синхронная функция задержки вымышленная:

```javascript
function greet() {
    console.log("Hello!");
}
delay(5000);
greet(); // выведется через 5 секунд бездействия
```

-   В асинхронном программировании задачи могут выполняться параллельно (многопоточно). Это означает, что одна задача не блокирует выполнение других задач. В контексте Node.js, это особенно важно при работе с операциями ввода-вывода (I/O), такими как доступ к файловой системе или сетевые запросы.

```javascript
setTimeout(function greet() {
    console.log("Hello!"); // выведется вторым
}, 5000);
console.log("I'm being called before greet function."); // выведется первым
```

[MDN](https://developer.mozilla.org/ru/docs/Web/JavaScript/Event_loop#%D0%B2%D0%B8%D0%B7%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%B5%D0%B4%D1%81%D1%82%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5): Параллелизм/Многопоточность в JavaScript работает за счёт цикла событий ( **event loop** ), который отвечает за выполнение кода, сбора и обработки событий и выполнения под-задач из очереди ( **queued sub-tasks** ). Эта модель весьма отличается от других языков программирования, таких как C и Java.

[Асинхронность в JS - doka.guide](https://doka.guide/js/async-in-js/)

[Филипп Робертс: Что за чертовщина такая event loop?](https://www.youtube.com/watch?v=8aGhZQkoFbQ&t=389s)

#### Преимущества асинхронности в Node.js

-   Node.js использует асинхронные, неблокирующие операции ввода/вывода. Это позволяет серверу обрабатывать другие задачи, пока ожидается завершение операции ввода/вывода, улучшая таким образом производительность и масштабируемость.
-   Асинхронные операции позволяют приложению обрабатывать больше запросов за меньшее время, поскольку сервер не "засыпает" в ожидании завершения каждой операции.

#### Примеры асинхронности в Node.js

-   **Чтение файла**:

    -   _Синхронный подход_: `readFileSync()` останавливает выполнение кода, пока файл не будет полностью прочитан.
    -   _Асинхронный подход_: `readFile()` позволяет программе продолжать выполнение других задач, пока файл читается, а результат чтения обрабатывается в коллбэк-функции.

-   **Запросы к серверу**:

    -   В асинхронном сервере на Node.js, входящие запросы обрабатываются параллельно, и сервер может принимать другие запросы, даже если предыдущий запрос еще обрабатывается.

#### **Модель обработки событий**

##### Основы событийно-ориентированной модели

-   **Событийно-ориентированная архитектура**: В Node.js большинство действий происходит в ответ на события. События могут быть любыми вещами: завершением чтения файла, получением запроса от клиента, ошибками или пользовательскими событиями.
-   **Цикл событий (Event Loop)**: Это сердце модели обработки событий. Цикл событий непрерывно ожидает события и отправляет их на обработку соответствующим обработчикам (callback-функциям).

##### Как это работает в Node.js

-   **Асинхронные вызовы**: Когда в Node.js происходит асинхронный вызов, например, запрос к базе данных, он регистрируется, и выполнение кода продолжается. После завершения асинхронной операции, например, получения ответа от базы данных, генерируется событие.
-   **Обработка событий**: Это событие попадает в очередь событий и ожидает обработки. Когда цикл событий достигает этого события, соответствующий обработчик (callback) вызывается.

##### Пример с HTTP-сервером

-   **Создание сервера**: При создании HTTP-сервера в Node.js, вы определяете функцию обратного вызова, которая вызывается каждый раз, когда сервер получает новый запрос.
-   **Обработка запросов**: Каждый входящий запрос является событием. Node.js обрабатывает эти события асинхронно, позволяя серверу обрабатывать множество запросов одновременно.

### Скорость - Производительность Node.js и V8 JavaScript Engine

#### Что такое V8 JavaScript Engine?

-   **Описание**: V8 — это высокопроизводительный движок JavaScript, разработанный Google и используемый в браузере Chrome. Node.js использует V8 для компиляции JavaScript кода в машинный код.
-   **Преимущества**: Благодаря тому, что V8 компилирует JavaScript напрямую в машинный код, это значительно увеличивает скорость выполнения кода по сравнению с интерпретацией или промежуточной компиляцией в байт-код.

Производительность Node.js

-   **Быстрое выполнение кода**: Способность V8 быстро компилировать и выполнить JavaScript приводит к высокой производительности приложений на Node.js.
-   **Оптимизация**: V8 постоянно обновляется и оптимизируется, что делает Node.js еще более быстрым и эффективным с течением времени.

#### Масштабируемость

-   **Одновременные соединения**: Node.js позволяет обрабатывать большое количество одновременных соединений с минимальным накладным расходом, благодаря асинхронной и событийно-ориентированной архитектуре.
-   **Неблокирующий ввод/вывод**: Сочетание высокой скорости выполнения кода и неблокирующего ввода/вывода делает Node.js идеальным для приложений, где требуется быстрая обработка большого объема операций ввода/вывода.

### Настройка окружения под разные операционные системы

#### Linux

1. **Обновление пакетов**: Для начала обновите список доступных пакетов и установленные программы:
    ```
    sudo apt-get update
    sudo apt-get upgrade
    ```
2. **Установка Node.js**: Установите Node.js с помощью менеджера пакетов:
    ```
    sudo apt-get install nodejs
    ```
3. **Установка npm (Node Package Manager)**:
    ```
    sudo apt-get install npm
    ```
4. **Проверка установки**: Проверьте, что Node.js и npm установлены правильно:
    ```
    node -v
    npm -v
    ```

#### macOS

1. **Использование Homebrew**: Homebrew - это менеджер пакетов для macOS. Если он еще не установлен, его можно установить через терминал:
    ```
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    ```
2. **Установка Node.js**: После установки Homebrew установите Node.js:
    ```
    brew install node
    ```
3. **Проверка установки**: Убедитесь, что Node.js и npm были установлены правильно:
    ```
    node -v
    npm -v
    ```

#### Windows

1. **Установка Chocolatey**: Chocolatey - это менеджер пакетов для Windows. Откройте PowerShell как администратор и выполните:

    ```powershell
    Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
    ```

2. **Установка Node.js через Chocolatey**:

    ```powershell
    choco install nodejs
    ```

3. **Проверка установки**: После установки проверьте версии Node.js и npm:node -v

    ```powershell
    npm -v
    node -v
    ```

### Инструменты для разработки и отладки

#### Обзор инструментов и IDE

1. **Cloud 9**: Облачная IDE, предоставляющая полноценное средство для разработки на Node.js. Она включает в себя редактор, отладчик и терминал, доступные прямо в браузере.
2. **WebStorm**: Мощная IDE от JetBrains, специально разработанная для JavaScript и Node.js. Она предлагает глубокую интеграцию с Node.js, инструментами тестирования и системами контроля версий.
3. **Eclipse**: Популярная IDE, которую можно настроить для работы с Node.js с помощью плагинов. Хотя Eclipse традиционно используется для Java, его можно эффективно применять и для JavaScript-разработки.
4. **VS Code**: Быстрый и легкий редактор от Microsoft с богатыми возможностями для разработки на Node.js, включая отладку, управление версиями и широкий выбор расширений.
5. **Sublime Text**: Легковесный, но мощный текстовый редактор с множеством плагинов для улучшения разработки на Node.js.

#### Настройка проекта на Node.js в VS Code

1. **Загрузите** и установите Visual Studio Code с [официального сайта](https://code.visualstudio.com/).
2. **Установите полезные расширения**, такие как `ESLint` для линтинга кода и `Node.js Extensions Pack` для улучшения работы с Node.js.
3. **Создайте новую папку** вашего проекта на Node.js и откройте ее `File > Open Folder` .
4. **Откройте терминал** в VS Code `Open in integrated Terminal`.
5. **Инициализируйте проект Node.js**: Введите в терминале `npm init` и следуйте инструкциям для создания файла `package.json`.
6. **Создайте** файл `index.js` в корне вашего проекта.
7. **Откройте** файл `index.js` и напишите следующий код:

```javascript
const http = require("http");
const server = http.createServer((req, res) => {
    res.statusCode = 200;
    res.setHeader("Content-Type", "text/plain");
    res.end("Привет, это мой первый Node.js сервер!");
});
const PORT = 3000;
server.listen(PORT, () => {
    console.log(
        `Сервер запущен на порту ${PORT}. Откройте http://localhost:${PORT}`,
    );
});
```

8. **Вернитесь** в терминал VS Code.
9. **Запустите сервер**, выполнив команду `node index.js`.

Если всё выполнено правильно, вы увидите сообщение: `Сервер запущен на порту 3000. Откройте` [http://localhost:3000](http://localhost:3000).

##### Разбор Кода

1. **Подключение модуля HTTP**:

    ```javascript
    const http = require("http");
    ```

    Здесь мы подключаем встроенный модуль Node.js, называемый `http`, который позволяет Node.js передавать данные по протоколу HTTP. `require('http')` загружает модуль HTTP и возвращает объект, который мы присваиваем переменной `http`.

2. **Создание HTTP-сервера**:

    ```javascript
    const server = http.createServer((req, res) => {
        res.statusCode = 200;
        res.setHeader("Content-Type", "text/plain");
        res.end("Привет, это мой первый Node.js сервер!");
    });
    ```

    - `http.createServer()` — функция, предоставляемая модулем HTTP для создания нового HTTP-сервера.
    - `req` (запрос) и `res` (ответ) — объекты, представляющие входящий запрос и исходящий ответ соответственно.
    - `res.statusCode = 200;` устанавливает статусный код ответа HTTP в 200, что означает успешный ответ.
    - `res.setHeader('Content-Type', 'text/plain');` устанавливает заголовок ответа, указывая, что контент будет текстовым.
    - `res.end('Привет, это мой первый Node.js сервер!');` завершает ответ, отправляя строку клиенту.

3. **Запуск сервера и прослушивание порта**:

    ```javascript
    const PORT = 3000;
    server.listen(PORT, () => {
        console.log(
            `Сервер запущен на порту ${PORT}. Откройте http://localhost:${PORT}`,
        );
    });
    ```

    - Здесь сервер настраивается на прослушивание входящих подключений на порту 3000.
    - `server.listen(PORT, callback)` запускает сервер и ожидает подключений на указанном порту. После запуска сервера, выполняется callback-функция, которая выводит сообщение в консоль.

###### Как это работает

Когда сервер запущен и прослушивает порт 3000, он ожидает входящие HTTP-запросы. При получении запроса он вызывает функцию, указанную в `createServer()`, с объектами `req` и `res`. Эта функция обрабатывает запрос (в нашем случае она не анализирует детали запроса) и отправляет ответ: строку "Привет, это мой первый Node.js сервер!".

Пользователь может увидеть этот ответ, перейдя по адресу `http://localhost:3000` в браузере. Когда браузер отправляет запрос на этот адрес, сервер принимает запрос и возвращает установленный нами текстовый ответ.

#### Отладка в VS Code

##### Шаги для отладки Node.js проекта в VS Code

###### Шаг 1: Настройка Конфигурации Отладки

1. **Открытие вкладки "Run"**: В боковой панели VS Code нажмите на иконку "Run" (или используйте сочетание клавиш `Ctrl + Shift + D` на Windows/Linux или `Cmd + Shift + D` на macOS).
2. **Добавление конфигурации отладки**:
    - В верхней части панели "Run" нажмите на кнопку "Create a launch.json file".
    - VS Code предложит вам выбрать среду. Выберите "Node.js".
    - Это создаст файл `launch.json` в папке `.vscode` вашего проекта, который содержит конфигурацию для отладки.

###### Шаг 2: Установка Точек Останова

1. **Открытие файла `index.js`**: В файле `index.js` вашего проекта найдите места в коде, где вы хотите остановить выполнение для проверки. Это могут быть ключевые моменты в логике обработки запроса.
2. **Установка точек останова**:
    - Кликните на поле слева от номера строки, где вы хотите установить точку останова. Появится красный кружок, обозначающий точку останова.

###### Шаг 3: Запуск Отладчика

1. **Запуск сессии отладки**:
    - Нажмите зеленую стрелку на панели "Run", или используйте клавишу F5 для запуска отладчика.
    - VS Code запустит ваш Node.js сервер в режиме отладки.

###### Шаг 4: Использование Отладчика

1. **Просмотр переменных**:
    - Когда выполнение остановится на точке останова, вы можете просмотреть значения переменных в текущем контексте. В левой части экрана появится панель с переменными, где можно увидеть их текущие значения.
2. **Шаги выполнения**:
    - Используйте кнопки "Step Over" (перейти к следующей строке), "Step Into" (войти в функцию) или "Step Out" (выйти из функции), чтобы контролировать выполнение вашего кода.
3. **Анализ стека вызовов**:
    - В нижней части окна отладки вы можете увидеть стек вызовов, который показывает последовательность вызовов функций до текущей точки выполнения.
4. **Продолжение выполнения**:
    - Чтобы продолжить выполнение программы до следующей точки останова или до её окончания, нажмите "Continue" (или F5).

###### Шаг 5: Завершение Отладки

-   Когда вы закончите отладку, можно остановить сервер, нажав на красный квадрат в панели отладки.

### Основные компоненты Node.js приложения

#### Модуль

-   **Что такое модуль**:

    -   В Node.js модуль - это отдельный файл с JavaScript кодом, который можно использовать в других файлах. Модули делают код более управляемым и позволяют легко разделять и повторно использовать код.

-   **Создание модуля**:

    -   Создайте файл JavaScript, например, `myModule.js`.
    -   Определите в нем функцию или переменные, которые вы хотите экспортировать.
    -   Используйте `module.exports` для экспорта этих элементов.
        ```javascript
        // myModule.js
        function sayHello(name) {
            return `Hello, ${name}!`;
        }
        module.exports = sayHello;
        ```

-   **Использование модуля**:

    -   В другом файле Node.js используйте `require` для импорта модуля.
        ```javascript
        // app.js
        const sayHello = require("./myModule");
        console.log(sayHello("World")); // Выведет: Hello, World!
        ```

#### Объекты request и response

-   **Работа с HTTP-запросами и ответами**:
    -   Каждый входящий запрос (`req`) содержит информацию о запросе клиента, такую как URL, заголовки, метод (GET, POST и т.д.).
    -   Объект ответа (`res`) используется для отправки ответа клиенту. Можно устанавливать заголовки, статусные коды и тело ответа.
        ```javascript
        server.on("request", (req, res) => {
            // В зависимости от URL запроса, можно отправить различные ответы
            if (req.url === "/about") {
                res.end("Обо мне");
            } else {
                res.end("Главная страница");
            }
        });
        ```

### Структура базового приложения

#### Шаг 1: Инициализация проекта

1. **Создайте новую папку** для вашего проекта (например, `simple-node-app`).
2. **Откройте эту папку** в Visual Studio Code или в вашем любимом текстовом редакторе.
3. **Откройте терминал** в этой папке (в VS Code это можно сделать через `Terminal > New Terminal`).
4. **Инициализируйте проект Node.js** командой `npm init -y`. Это создаст файл `package.json` с базовыми настройками проекта.

#### Шаг 2: Создание Структуры Приложения

1. **Создайте основной файл приложения**. Например, `index.js`, который будет точкой входа в ваше приложение.
2. **Создайте папку `modules`** для разделения логики приложения на модули.

#### Шаг 3: Создание Модулей

1. В папке `modules`, создайте файл, например, `greetings.js`. Этот модуль будет отвечать за предоставление приветственных сообщений.

    ```javascript
    // modules/greetings.js
    function sayHello(name) {
        return `Привет, ${name}!`;
    }

    module.exports = sayHello;
    ```

2. Теперь у вас есть модуль `greetings`, который можно использовать в основном файле приложения.

#### Шаг 4: Импорт и Использование Модуля в Приложении

1. В файле `index.js`, импортируйте и используйте модуль `greetings`.

    ```javascript
    // index.js
    const http = require("http");
    const sayHello = require("./modules/greetings");

    const server = http.createServer((req, res) => {
        res.statusCode = 200;
        res.setHeader("Content-Type", "text/plain");
        res.end(sayHello("Мир"));
    });

    const PORT = 3000;
    server.listen(PORT, () => {
        console.log(`Сервер запущен на http://localhost:${PORT}`);
    });
    ```

    Здесь мы создаем HTTP-сервер, который использует функцию `sayHello` из модуля `greetings` для отправки приветственного сообщения.

#### Шаг 5: Запуск Приложения

1. **Запустите приложение** командой `node index.js` в терминале.
2. Перейдите по адресу `http://localhost:3000` в вашем браузере. Вы должны увидеть сообщение, возвращаемое модулем `greetings`.

#### Шаг 6: Создание Дополнительных Модулей

1. **Модуль для работы с датой и временем (`dateModule.js`)**:

    - Этот модуль будет возвращать текущие дату и время.

    ```javascript
    // modules/dateModule.js
    function getCurrentDateTime() {
        return new Date().toString();
    }

    module.exports = getCurrentDateTime;
    ```

2. **Модуль логирования (`logModule.js`)**:

    - Модуль для логирования различных событий.

    ```javascript
    // modules/logModule.js
    function log(message) {
        console.log(`[Log]: ${message}`);
    }

    module.exports = log;
    ```

3. **Модуль аутентификации (`authModule.js`)**:

    - Простой модуль для имитации процесса аутентификации.

    ```javascript
    // modules/authModule.js
    function authenticate(user) {
        return user === "admin";
    }

    module.exports = authenticate;
    ```

#### Шаг 7: Интеграция Модулей в Приложение

1. **Импорт модулей в `index.js`**:

    - Теперь необходимо импортировать и использовать эти модули в основном файле приложения.

    ```javascript
    // index.js
    const http = require("http");
    const sayHello = require("./modules/greetings");
    const getCurrentDateTime = require("./modules/dateModule");
    const log = require("./modules/logModule");
    const authenticate = require("./modules/authModule");

    const server = http.createServer((req, res) => {
        if (!authenticate("user")) {
            res.statusCode = 403;
            res.end("Нет доступа");
            return;
        }

        log(`Запрос получен: ${req.url}`);
        res.statusCode = 200;
        res.setHeader("Content-Type", "text/plain");
        res.end(`${sayHello("Мир")}\nТекущее время: ${getCurrentDateTime()}`);
    });

    const PORT = 3000;
    server.listen(PORT, () => {
        console.log(`Сервер запущен на http://localhost:${PORT}`);
    });
    ```

#### Шаг 8: Изменение серверного кода для маршрутизации

Для того чтобы каждый модуль открывался с разной страницы, мы можем настроить наш сервер так, чтобы он обрабатывал разные URL-адреса для каждого модуля. Давайте модифицируем наш серверный код в `index.js`, чтобы обеспечить разные маршруты для каждого модуля.

##### **Импортируйте модули** в `index.js`:

1. ```javascript
   const http = require("http");
   const sayHello = require("./modules/greetings");
   const getCurrentDateTime = require("./modules/dateModule");
   const log = require("./modules/logModule");
   const authenticate = require("./modules/authModule");
   ```
2. ##### **Настройте маршрутизацию**:

    - Для каждого запроса проверьте URL и определите, какой модуль должен его обработать.

    ```javascript
    const server = http.createServer((req, res) => {
        const urlPath = req.url;

        if (!authenticate("admin")) {
            res.statusCode = 403;
            res.end("Нет доступа");
            return;
        }

        if (urlPath === "/hello") {
            res.statusCode = 200;
            res.setHeader("Content-Type", "text/plain");
            res.end(sayHello("Мир"));
        } else if (urlPath === "/date") {
            res.statusCode = 200;
            res.setHeader("Content-Type", "text/plain");
            res.end(`Текущее время: ${getCurrentDateTime()}`);
        } else if (urlPath === "/log") {
            log("Логирование запроса");
            res.statusCode = 200;
            res.setHeader("Content-Type", "text/plain");
            res.end("Проверьте консоль для логов");
        } else {
            res.statusCode = 404;
            res.end("Страница не найдена");
        }
    });
    ```

3. **Запуск сервера**:

    ```javascript
    const PORT = 3000;
    server.listen(PORT, () => {
        console.log(`Сервер запущен на http://localhost:${PORT}`);
    });
    ```

##### Инструкция по использованию

-   Запустите сервер: `node index.js`.
-   Откройте браузер и перейдите по следующим адресам:
    -   `http://localhost:3000/hello` - отобразит приветствие от модуля `greetings`.
    -   `http://localhost:3000/date` - покажет текущую дату и время от модуля `dateModule`.
    -   `http://localhost:3000/log` - выполнит функцию логирования в консоли и покажет сообщение об этом в браузере.
