# Взаимодействие со средой Node.js

### Особенности использования командной строки

Работа с командной строкой (CLI) для Node.js охватывает несколько ключевых аспектов. Node.js - это среда выполнения JavaScript, которая позволяет запускать код JS на серверной стороне. Вот основы работы с командной строкой для Node.js:

#### Установка Node.js

Для начала вам нужно установить Node.js. Вы можете скачать его с официального сайта [Node.js](https://nodejs.org/). После установки вы можете проверить версию Node.js и npm (менеджер пакетов Node), выполнив команды:

```bash
node -v
npm -v
```

#### Создание JavaScript-файла

Создайте файл с расширением `.js`, например, `app.js`. В этом файле вы можете написать код на JavaScript, который будет выполняться в Node.js.

#### Запуск файла

Для запуска файла используйте команду:

```bash
node app.js
```

Эта команда выполнит код в файле `app.js`.

#### Использование npm

Npm используется для управления зависимостями и пакетами в вашем проекте Node.js. Для создания нового проекта Node.js и файла `package.json`, запустите:

```bash
npm init
```

Этот файл будет управлять вашими зависимостями и скриптами.

#### Установка пакетов

Для установки внешних библиотек и фреймворков используйте npm. Например, для установки Express.js выполните:

```bash
npm install express
```

#### Импорт модулей

В Node.js вы можете использовать `require()` для импорта модулей. Например:

```javascript
const express = require("express");
```

#### Работа с глобальными пакетами

Некоторые пакеты, такие как nodemon, устанавливаются глобально для удобства разработки:

```bash
npm install -g nodemon
```

Nodemon автоматически перезапускает ваше приложение при изменении файлов.

#### Использование скриптов

В `package.json` вы можете определить скрипты для запуска задач. Например:

```json
"scripts": {
  "start": "node app.js"
}
```

Запустите этот скрипт командой:

```bash
npm start
```

#### Отладка

Node.js поддерживает отладку через инструменты разработчика в браузерах или IDE. Вы можете запустить Node.js в режиме отладки командой:

```bash
node --inspect app.js
```

### Использование REPL в Node.js

#### Знакомство с REPL (Read-Eval-Print Loop).

REPL (Read-Eval-Print Loop) в Node.js - это очень полезный инструмент для разработчиков. Он позволяет быстро тестировать и экспериментировать с кодом JavaScript, не создавая полноценный файл.

#### Как запустить REPL

Для запуска REPL достаточно открыть терминал и написать `node`, после чего нажать Enter. Если Node.js установлен, REPL запустится, показывая `>`.

#### Базовые операции в REPL

-   **Выполнение кода JavaScript**: Вы можете набирать любой стандартный код JavaScript и получать результаты сразу. Например, попробуйте `console.log('Hello, World!')`.
-   **Использование переменных**: Вы можете объявлять переменные, как обычно. Например, `let a = 10;`.
-   **Многострочный код**: Если ваш код требует нескольких строк, REPL позволяет вам это делать. Просто нажимайте Enter после каждой строки. REPL поймет, что вы продолжаете вводить код.
-   **История команд**: Вы можете переключаться между предыдущими командами с помощью стрелок вверх и вниз.
-   **Автодополнение**: REPL поддерживает автодополнение. Начните набирать код, и нажмите Tab для отображения возможных завершений.
-   **Специальные команды REPL**:

    -   `.help`: Показывает список всех доступных команд.
    -   `.save filename`: Сохраняет текущую сессию REPL в файл.
    -   `.load filename`: Загружает файл в текущую сессию REPL.
    -   `.exit`: Выход из REPL.

#### Ограничения REPL

Хотя REPL отлично подходит для тестирования небольших фрагментов кода, он не является идеальным для работы с большими, сложными приложениями. Для более сложных проектов лучше использовать среду разработки и создавать файлы с кодом.

### Базовые операции в REPL для испытания кода JavaScript.

#### Простой JavaScript-код

1. **Запуск REPL**: Открываем терминал и вводим `node`, после чего нажимаем Enter.
2. **Вводим код**: Пишем `console.log('Hello, REPL!');` и нажимаем Enter.
3. **Результат**: REPL выводит `Hello, REPL!` и возвращается к приглашению ввода `>`.

#### Работа с переменными

1. **Объявление переменной**: Вводим `let number = 5;` и нажимаем Enter.
2. **Использование переменной**: Пишем `console.log(number * 2);` и нажимаем Enter.
3. **Результат**: REPL выводит `10`.

#### Многострочный код

1. **Начало многострочного кода**: Вводим `function greet(name) {` и нажимаем Enter.
2. **Продолжение кода**: Добавляем `return 'Hello ' + name;` и снова нажимаем Enter.
3. **Завершение функции**: Вводим `}` и нажимаем Enter.
4. **Использование функции**: Пишем `console.log(greet('Alice'));` и нажимаем Enter.
5. **Результат**: REPL выводит `Hello Alice`.

#### Использование специальных команд

1. **Сохранение сессии**: После выполнения некоторого кода вводим `.save mysession.js` и нажимаем Enter.
    - Это сохранит всё, что было введено в текущей сессии, в файл `mysession.js`.
2. **Выход из REPL**: Вводим `.exit` и нажимаем Enter.

#### Загрузка кода из файла

1. **Запуск REPL**: Открываем терминал, вводим `node`.
2. **Загрузка файла**: Вводим `.load mysession.js`.
    - Это загрузит код из файла `mysession.js` в текущую сессию REPL.

### Замечания REPL

#### Важность REPL для Обучения и Прототипирования

1. **Интерактивное Обучение**: REPL позволяет новичкам быстро изучать и экспериментировать с JavaScript. Студенты могут мгновенно видеть результаты своего кода, что ускоряет понимание языка программирования и концепций.
2. **Прототипирование**: Для опытных разработчиков REPL служит инструментом для быстрого прототипирования и тестирования кода. Это может быть особенно полезно при изучении новых библиотек или API.

#### REPL как Дополнение, а не Замена Среды Разработки

1. **Ограниченность REPL**: Несмотря на свою удобство и простоту, REPL не предназначен для работы с большими проектами. Он идеален для коротких фрагментов кода, но не для сложной разработки.
2. **Важность Интегрированных Сред Разработки (IDE)**: Для более крупных проектов необходимо использовать IDE. IDE предоставляют множество инструментов, таких как отладка, управление версиями и интеграция с различными библиотеками и фреймворками.

#### Эффективное Использование Команд `.save` и `.load`

1. **Сохранение Работы**: Команда `.save` в REPL позволяет сохранять всю историю команд в файл, что полезно для документирования процесса обучения или сохранения примеров кода для последующего использования.
2. **Загрузка Кода для Повторного Использования**: Команда `.load` облегчает загрузку ранее сохраненного кода обратно в REPL. Это экономит время и позволяет быстро восстанавливать предыдущие сессии работы.

## Менеджер пакетов npm

### Основы npm

#### Что такое Node Package Manager?

Node Package Manager (NPM) — это менеджер пакетов для языка программирования JavaScript. Он является стандартным инструментом для управления зависимостями в проектах, использующих Node.js, платформу для выполнения JavaScript на стороне сервера. Вот подробное объяснение NPM и его основных функций:

#### Что такое NPM?

1. **Менеджер Пакетов**: NPM позволяет разработчикам устанавливать, обновлять и использовать сторонние пакеты (библиотеки или модули). Эти пакеты могут быть найдены в NPM реестре, который содержит тысячи пакетов, разработанных сообществом.
2. **Реестр**: NPM подключается к огромному реестру пакетов, где хранятся библиотеки и инструменты. Это централизованное хранилище позволяет легко находить и использовать нужные пакеты в вашем проекте.
3. **Управление Зависимостями**: Одна из ключевых функций NPM — управление зависимостями в проекте. Это означает, что вы можете указать, какие внешние библиотеки нужны вашему проекту, и NPM будет управлять их установкой, обновлением и конфигурацией.
4. **Файл `package.json`**: В каждом проекте, использующем NPM, есть файл `package.json`, который содержит метаданные проекта, список зависимостей и другую конфигурацию. Этот файл служит как «паспорт» проекта.

#### Основные Функции NPM

1. **Установка Пакетов**: Вы можете установить любой пакет из реестра NPM, используя команду `npm install имя_пакета`. Установка может быть локальной (только в текущем проекте) или глобальной (доступной во всех проектах на вашем компьютере).
2. **Обновление и Удаление Пакетов**: NPM позволяет обновлять и удалять установленные пакеты. Это важно для поддержания актуальности кода и устранения уязвимостей.
3. **Создание и Публикация Пакетов**: Если вы разработали свой собственный модуль, вы можете опубликовать его в реестре NPM, сделав доступным для других разработчиков.
4. **Скрипты**: Файл `package.json` может содержать скрипты, которые упрощают выполнение задач, таких как запуск, тестирование или сборка проекта.
5. **Версионирование и `package-lock.json`**: NPM управляет версиями пакетов, что важно для стабильности и совместимости зависимостей. Файл `package-lock.json` фиксирует точные версии установленных пакетов, гарантируя одинаковую среду разработки для всех участников проекта.

### Основные команды npm.

#### `npm init`

Эта команда используется для инициализации нового проекта Node.js. Она создает файл `package.json`, который содержит информацию о проекте и его зависимостях.

```bash
npm init
```

Вы также можете использовать `npm init -y` для автоматического создания файла `package.json` с дефолтными значениями.

#### `npm install` или `npm i`

Команда для установки пакета или библиотеки. Вы можете установить как конкретный пакет, так и все зависимости, перечисленные в файле `package.json`.

-   Установка конкретного пакета:
    ```bash
    npm install express
    ```
-   Установка всех зависимостей проекта:
    ```bash
    npm install
    ```

#### `npm install <пакет> --save-dev` или `npm i <пакет> -D`

Установка пакета как разработческой зависимости (например, инструменты для тестирования или сборки).

```bash
npm install jest --save-dev
```

#### `npm update`

Обновление всех установленных пакетов до последних доступных версий с учетом ограничений, указанных в `package.json`.

```bash
npm update
```

#### `npm uninstall <пакет>`

Удаление пакета из зависимостей проекта.

```bash
npm uninstall lodash
```

#### `npm run <скрипт>`

Запуск определенного скрипта, указанного в разделе `scripts` файла `package.json`.

```bash
npm run start
```

#### `npm list`

Отображение установленных пакетов и их зависимостей для текущего проекта.

```bash
npm list
```

#### `npm list -g --depth 0`

Отображение всех глобально установленных пакетов.

```bash
npm list -g --depth 0
```

#### `npm cache clean --force`

Очистка кеша npm. Это может быть полезно при решении проблем с установкой пакетов.

```bash
npm cache clean --force
```

#### `npm audit`

Проверка установленных зависимостей на наличие известных уязвимостей.

```bash
npm audit
```

### Пакеты и модули в Node.js.

#### Модуль в Node.js

Модуль в Node.js — это отдельный файл JavaScript, который исполняется в собственной области видимости. То есть, переменные, функции, классы и другие конструкции, объявленные в модуле, не доступны напрямую в других модулях, если только они явно не экспортируются.

**Экспорт и Импорт**:

-   **Экспорт**: Модули могут экспортировать функции, объекты, классы для использования в других файлах. Это делается с помощью `module.exports` или `exports`.
-   **Импорт**: Для использования функциональности, экспортированной из другого модуля, используется `require()`. Когда вы вызываете `require('путь_к_модулю')`, Node.js загружает модуль и предоставляет доступ к его экспортируемым элементам.

**Примеры**:

-   Создание модуля:
    ```javascript
    // math.js
    const add = (a, b) => a + b;
    module.exports = { add };
    ```
-   Использование модуля:
    ```javascript
    // app.js
    const math = require("./math");
    console.log(math.add(2, 3)); // 5
    ```

#### Пакет в Node.js

**Определение**:

-   Пакет в Node.js - это каталог, содержащий один или несколько модулей, а также файл `package.json`, который описывает пакет, включая его зависимости, скрипты, версию и другую информацию.

**package.json**:

-   Этот файл является ключевым для пакета. Он содержит метаданные о пакете и используется npm (Node Package Manager) для управления зависимостями пакета, его установки и публикации.

**Установка пакетов**:

-   Пакеты устанавливаются с помощью npm или другого менеджера пакетов (например, Yarn). Это могут быть как внешние библиотеки, доступные в реестре npm, так и локальные пакеты.

**Примеры**:

-   Установка внешнего пакета:
    ```bash
    npm install express
    ```
-   В вашем проекте создается каталог `node_modules`, в котором хранятся все установленные пакеты.

**Зависимости**:

-   В `package.json` перечисляются зависимости - другие пакеты, необходимые для работы вашего пакета. Эти зависимости автоматически устанавливаются при установке вашего пакета.

### Создание и регистрация собственных модулей.

Создание и регистрация собственных модулей в Node.js является важной частью разработки приложений. Это позволяет организовать ваш код в более читаемую и поддерживаемую структуру, а также делиться кодом между разными частями вашего приложения или между разными проектами. Давайте подробно рассмотрим этот процесс:

#### Создание Собственных Модулей

Для создания собственных модулей в Node.js, вам нужно выполнить следующие шаги:

1. **Создайте файл модуля**: Создайте файл с расширением `.js`, который будет содержать ваш модуль. Например, `myModule.js`.
2. **Определите функциональность модуля**: Внутри файла определите функции, объекты или классы, которые вы хотите сделать доступными извне модуля. Используйте `module.exports` или `exports`, чтобы экспортировать эти элементы.

    ```javascript
    // myModule.js
    function sayHello() {
        console.log("Hello from my module!");
    }

    module.exports = {
        sayHello,
    };
    ```

#### Использование Собственных Модулей

Чтобы использовать ваш собственный модуль в других частях вашего приложения, выполните следующие шаги:

1. **Импортируйте модуль**: Используйте `require()` для импорта вашего модуля. Укажите путь к файлу модуля, который вы хотите импортировать.

    ```javascript
    const myModule = require("./myModule");
    ```

2. **Используйте экспортированные элементы**: Теперь вы можете использовать функции, объекты или классы, которые были экспортированы из вашего модуля.

    ```javascript
    myModule.sayHello(); // Вызывает функцию из вашего модуля
    ```

#### Регистрация Модуля в package.json

Если вы хотите опубликовать свой модуль в реестре npm или использовать его в других проектах, вам нужно зарегистрировать модуль в файле `package.json` вашего проекта. Добавьте раздел `"dependencies"` или `"devDependencies"` и укажите путь к модулю или URL к git-репозиторию.

Пример `package.json` с зарегистрированным модулем:

```json
{
    "name": "my-app",
    "version": "1.0.0",
    "dependencies": {
        "my-module": "file:./myModule" // Указание пути к модулю
    }
}
```

#### Публикация Модуля в npm (по желанию)

Если вы хотите, чтобы ваш модуль был доступен для других разработчиков через реестр npm, вы можете опубликовать его. Для этого выполните следующие шаги:

1. **Создайте аккаунт на npm**: Зарегистрируйтесь на [сайте npm](https://www.npmjs.com/) (если вы еще не зарегистрированы).
2. **Логин в npm**: В командной строке выполните команду `npm login` и введите ваши учетные данные.
3. **Публикация модуля**: В директории с вашим модулем выполните `npm publish`. Ваш модуль будет опубликован в реестре npm.
4. **Обновление версии**: Когда вы вносите изменения в модуль, не забудьте обновить версию в файле `package.json`, а затем выполнить `npm publish` снова.
